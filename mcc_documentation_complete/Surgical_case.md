# Surgical Case Data Mart

## Description

Surgical procedures done for the patient. These are historic documents, they have not been updated since the EPIC go live.

## Diagram

[![Surgical Case Data Model](/assets/images/fact_surgical_case-10ed2341be89dd60672e43b2f7919348.PNG)](https://mctools.sharepoint.com/teams/UDPDAIS/Shared%20Documents/UDP%20Data%20Mart%20Documents/Z_S2T_Model_for_Website/Data%20Models/10%29%20Surgical_Procedure/FACT_SURGICAL_CASE_MCC.pdf)

## Dataset Information

- **Project Id:** `ml-mps-adl-intudp-phi-p-d5cb`
- **Dataset:** `phi_udpwh_etl_us_p`
- **Entitlement:** `MCC Live - AIDE UDP General Marts PROD Analytics`
  - [User Access](/docs/data-analytics/user-access) | [Service Account Access](/docs/data-analytics/service-account-access)

**Former DB2 Database:** EDT4P
**Update Frequency:** Updated Nightly
**Support Group:** UDP Data Integration

## Mapping Specifications

- [SIRS (RST/ARZ/FLA)](https://mctools.sharepoint.com/teams/UDPDAIS/Shared%20Documents/UDP%20Data%20Mart%20Documents/Z_S2T_Model_for_Website/Surgical%20Procedure/Business%20Spec%20and%20S2T/SIRS_RST_ARZ_FLA/SIRS_Surgical_Procedure_Source_2_Target.xlsx?d=w9b28f88e4b6c4d5594f048e8d14ab048)
- [Cerner (MCHS)](https://mctools.sharepoint.com/teams/UDPDAIS/Shared%20Documents/UDP%20Data%20Mart%20Documents/Z_S2T_Model_for_Website/Surgical%20Procedure/Business%20Spec%20and%20S2T/MCHS/MCHS_Surgical_Procedure_Source_2_Target.xlsx?d=w9328cf44635744e6868c2d22150c89f3)
- [Epic](https://mctools.sharepoint.com/teams/UDPDAIS/Shared%20Documents/UDP%20Data%20Mart%20Documents/Z_S2T_Model_for_Website/Surgical%20Procedure/Business%20Spec%20and%20S2T/Epic/EPIC_Surgical_Procedure_Source_2_Target.xlsx?d=w49aba6d2f28b4703b0587b626fd439cc)

## Example Query

### Sample Query: 

This is a sample query to get you started. Query you need for your use case may be different than this sample.

```sql
SELECT PT.PATIENT_CLINIC_NUMBER, SYS.SOURCE_SYSTEM_NAME,
SC.SURGICAL_CASE_ID, SC.ENCOUNTER_NUMBER, SC.VISIT_NUMBER, SC.SURGICAL_CASE_DTM, SC.SURGICAL_INCISION_BEGIN_DTM,
SC.SURGICAL_CLOSURE_DTM, SC.SURGICAL_ANESTHESIA_START_DTM, SC.SURGICAL_ANESTHESIA_END_DTM, SC.SURGICAL_OPERATION_START_DTM,
SC.SURGICAL_OPERATION_END_DTM, SC.SURGICAL_ENTER_DEPT_DTM, SC.SURGICAL_PREPROCEDURE_DTM, SC.SURGICAL_POSTPROCEDURE_DTM,
SC.SURGICAL_OP_ROOM_ENTER_DTM, SC.SURGICAL_OP_ROOM_EXIT_DTM, SC.SURGICAL_CASE_CLASS, SC.SURGICAL_VISIT_TYPE,
SC.SURGICAL_ANESTHESIA_CODE, SC.SURGICAL_ANESTHESIA_DESCRIPTION, SC.SURGICAL_PRE_OP_DIAGNOSIS_NOTE,
SC.SURGICAL_PRE_OP_PROCEDURE_NOTE, SC.SURGICAL_POST_OP_DIAGNOSIS_NOTE, SC.SURGICAL_POST_OP_PROCEDURE_NOTE,

--==SURGERY LOCATION====
LOC.LOCATION_CODE, LOC.LOCATION_DESCRIPTION,

--=== SURGERY OR LOCATION
ORLOC.LOCATION_CODE AS OR_LOCATION_CODE, ORLOC.LOCATION_DESCRIPTION AS OR_LOCATION_DESCRIPTION,

--==== PRIMARY SURGEON
PROV.PROVIDER_FIRST_NAME, PROV.PROVIDER_LAST_NAME,
CS.CLINICAL_SERVICE_CODE, CS.CLINICAL_SERVICE_DESCRIPTION,
SCP.SURGICAL_CASE_PRIORITY_CODE, SCP.SURGICAL_CASE_PRIORITY_DESCRIPTION,

--==== PROCEDURE--=========
SPROC.SURGICAL_PROCEDURE_CODE, SPROC.SURGICAL_PROCEDURE_DESCRIPTION,
ALOC.ANATOMIC_LOCATION_CODE, ALOC.ANATOMIC_LOCATION_DESCRIPTION,
WT.WOUND_TYPE_CODE, WT.WOUND_TYPE_DESCRIPTION
FROM EDTWH.FACT_SURGICAL_CASE SC
JOIN EDTWH.DIM_PATIENT PT
ON (SC.PATIENT_DK = PT.PATIENT_DK)
JOIN EDTWH.DIM_CLINICAL_SERVICE CS
ON (SC.CLINICAL_SERVICE_DK = CS.CLINICAL_SERVICE_DK)
JOIN EDTWH.DIM_SURGICAL_CASE_PRIORITY SCP
ON (SC.SURGICAL_CASE_PRIORITY_DK = SCP.SURGICAL_CASE_PRIORITY_DK)
JOIN EDTWH.DIM_SOURCE_SYSTEM SYS
ON (SC.SOURCE_SYSTEM_DK = SYS.SOURCE_SYSTEM_DK)

--============ LOCATION JOINS============
JOIN EDTWH.DIM_LOCATION LOC
ON (SC.LOCATION_DK = LOC.LOCATION_DK)
JOIN EDTWH.DIM_LOCATION ORLOC
ON (SC.OPERATING_ROOM_LOCATION_DK=ORLOC.LOCATION_DK)

--============PROVIDER JOINS=============
JOIN EDTWH.DIM_HEALTHCARE_PROVIDER PROV
ON (SC.PRIMARY_PROVIDER_DK=PROV.PROVIDER_DK)

--============SURGICAL PROVIDER ROLE SERVICE BRIDGE=========
LEFT JOIN EDTWH.DIM_SURGICAL_PROVIDER_ROLE_SERVICE_BRIDGE SPRB
ON (SC.SURGICAL_CASE_FPK = SPRB.SURGICAL_CASE_FPK)
LEFT JOIN EDTWH.DIM_SURGICAL_PROVIDER_ROLE SR
ON (SPRB.SURGICAL_PROVIDER_ROLE_DK=SR.SURGICAL_PROVIDER_ROLE_DK)

--==========SURGICAL PROCEDURE JOINS=================
LEFT JOIN EDTWH.FACT_SURGICAL_CASE_PROCEDURE SCPROC
ON (SC.SURGICAL_CASE_FPK = SCPROC.SURGICAL_CASE_FPK)
LEFT JOIN EDTWH.DIM_SURGICAL_PROCEDURE SPROC
ON (SCPROC.SURGICAL_PROCEDURE_DK = SPROC.SURGICAL_PROCEDURE_DK)
LEFT JOIN EDTWH.DIM_ANATOMIC_LOCATION ALOC
ON (SCPROC.ANATOMIC_LOCATION_DK = ALOC.ANATOMIC_LOCATION_DK)
LEFT JOIN EDTWH.DIM_WOUND_TYPE WT
ON (SCPROC.WOUND_TYPE_DK = WT.WOUND_TYPE_DK)

--===========SURGICAL DIAGNOSIS==================
LEFT JOIN EDTWH.FACT_SURGICAL_CASE_DIAGNOSIS SCDIAG
ON (SC.SURGICAL_CASE_FPK = SCDIAG.SURGICAL_CASE_DIAGNOSIS_FPK)
LEFT JOIN EDTWH.DIM_DIAGNOSIS_CODE DC
ON (SCDIAG.DIAGNOSIS_CODE_DK = DC.DIAGNOSIS_CODE_DK)
```

SURGICAL CASES HAVE A 1 TO MANY RELATIOSHIP WITH CLINICAL DOCS THE RELATIONSHIP IS HOUSED WITHIN DIM_SURGICAL_CASE_NOTE_BRIDGE
```sql
SELECT
  SC.SURGICAL_CASE_ID,
  CD.CLINICAL_DOCUMENT_TEXT AS SURGICAL_REPORT
FROM FACT_SURGICAL_CASE SC
  INNER JOIN DIM_SURGICAL_CASE_NOTE_BRIDGE B
    ON SC.SURGICAL_CASE_FPK = B.SURGICAL_CASE_FPK
  INNER JOIN FACT_CLINICAL_DOCUMENTS CD
    ON B.PATIENT_DK = CD.PATIENT_DK
    AND B.CLINICAL_DOCUMENT_ID = CD.CLINICAL_DOCUMENT_ID
```