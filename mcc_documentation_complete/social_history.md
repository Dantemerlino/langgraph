# Social History Data Mart

## Description

Social History is a collection of various questions and answers provided by the patient. It is similar to Patient Provided Information.

## Diagram

[![Social History Data Model](/assets/images/fact_social_hist-40412222e44926baf13ac90dfd8e0010.PNG)](https://mctools.sharepoint.com/teams/UDPDAIS/Shared%20Documents/UDP%20Data%20Mart%20Documents/Z_S2T_Model_for_Website/Data%20Models/34%29%20Social%20Hx/FACT_SOCIAL_HX_MCC.pdf)

## Dataset Information

- **Project Id:** `ml-mps-adl-intudp-phi-p-d5cb`
- **Dataset:** `phi_udpwh_etl_us_p`
- **Entitlement:** `MCC Live - AIDE UDP General Marts PROD Analytics`
  - [User Access](/docs/data-analytics/user-access) | [Service Account Access](/docs/data-analytics/service-account-access)

**Former DB2 Database:** EDT4P
**Update Frequency:** Updated Nightly
**Support Group:** UDP Data Integration

## Mapping Specifications

- [Epic](https://mctools.sharepoint.com/teams/UDPDAIS/Shared%20Documents/UDP%20Data%20Mart%20Documents/Z_S2T_Model_for_Website/Social%20Hx/EPIC_Social_HX_Source_2_Target_New.xlsx?d=w0954cf106cea4c60aa9eb62b84976a5b)

## Example Query

### Sample Queries: 
1) Patient Full Social History by Clinic Number
```sql
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NUM,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where DP.PATIENT_CLINIC_NUMBER = 99999999 --Clinic Number
```

2) Patient Full Social History by Date Range

```sql 
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NUM,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where FS.SOCIAL_HISTORY_CONTACT_DTM BETWEEN '2021-05-31 00:00:00' AND '2021-05-31 23:59:59'
```
3) Social Smoking Status by Clinic Number
```sql 
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NUM,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where FS.SOCIAL_HISTORY_CONCEPT_NAME = 'Smoking Status'
  and DP.PATIENT_CLINIC_NUMBER = 99999999 --Clinic Number
```
4) Social Smoking Status by Date Range
```sql 
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NUM,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where FS.SOCIAL_HISTORY_CONTACT_DTM BETWEEN '2021-05-31 00:00:00' AND '2021-05-31 23:59:59'
  and FS.SOCIAL_HISTORY_CONCEPT_NAME = 'Smoking Status'
order by DP.PATIENT_CLINIC_NUMBER, FS.ENCOUNTER_NBR
```
5) Social Smoking Data by Clinic Number
```sql 
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NUM,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where
    (FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Smok%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Toba%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Cig%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Snuff%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Pipes%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Chew%')
  and DP.PATIENT_CLINIC_NUMBER = 9999999 --Clinic Number
```
6) Social Smoking Data by Date Range
```sql 
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NUM,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where FS.ROW_SOURCE_ID = 47918
  and FS.SOCIAL_HISTORY_CONTACT_DTM BETWEEN '2021-05-31 00:00:00' AND '2021-05-31 23:59:59'
  and (FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Smok%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Toba%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Cig%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Snuff%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Pipes%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Chew%')
order by DP.PATIENT_CLINIC_NUMBER, FS.ENCOUNTER_NBR
```
7) Social Alcohol Use by Clinic Number
```sql 
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NUM,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where FS.SOCIAL_HISTORY_CONCEPT_NAME = 'Do you consume Alcohol?'
  and DP.PATIENT_CLINIC_NUMBER = 9999999999 --Clinic Number
```
8) Social Alcohol Use by Date Range
```sql 
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NUM,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where FS.SOCIAL_HISTORY_CONTACT_DTM BETWEEN '2021-05-31 00:00:00' AND '2021-05-31 23:59:59'
  and FS.SOCIAL_HISTORY_CONCEPT_NAME = 'Do you consume Alcohol?'
order by DP.PATIENT_CLINIC_NUMBER, FS.ENCOUNTER_NBR
```
9) Social Alcohol Data by Clinic Number
```sql 
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NUM,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where(FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Alcoh%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Drink%')
  and DP.PATIENT_CLINIC_NUMBER = 99999999 --Clinic Number
```
10) Social Alcohol Data by Date Range
```sql 
select
  DP.PATIENT_CLINIC_NUMBER as CLIN_NUM,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where FS.SOCIAL_HISTORY_CONTACT_DTM BETWEEN '2021-05-31 00:00:00' AND '2021-05-31 23:59:59'
  and (FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Alcoh%' or
    FS.SOCIAL_HISTORY_CONCEPT_NAME like '%Drink%')
order by DP.PATIENT_CLINIC_NUMBER, FS.ENCOUNTER_NBR
```
11) Social Phone Communication by Clinic Number
```sql 
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NBR,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where FS.SOCIAL_HISTORY_CONCEPT_NAME = 'Social Phone Communication'
  and DP.PATIENT_CLINIC_NUMBER = 99999999 --Clinic Number
```
12) Social Phone Communication by Date Range
```sql
select
  DP.PATIENT_CLINIC_NUMBER as CLINIC_NBR,
  FS.ENCOUNTER_NBR,
  FS.PATIENT_AGE_AT_EVENT as PAT_AGE,
  FS.SITE_NAME as SITE,
  FS.SOCIAL_HISTORY_CONTACT_DTM as CONTACT_DATE,
  FS.SOCIAL_HISTORY_CONCEPT_NAME as SOCIAL_QUESTION,
  FS.SOCIAL_HISTORY_ANSWER as SOCIAL_ANSWER
from EDTWH.FACT_SOCIAL_HISTORY FS
  join EDTWH.DIM_PATIENT DP
    on DP.PATIENT_DK = FS.PATIENT_DK
where FS.SOCIAL_HISTORY_CONCEPT_NAME = 'Social Phone Communication'
  and FS.SOCIAL_HISTORY_CONTACT_DTM BETWEEN '2021-05-31 00:00:00' AND '2021-05-31 23:59:59'
order by DP.PATIENT_CLINIC_NUMBER, FS.ENCOUNTER_NBR
```